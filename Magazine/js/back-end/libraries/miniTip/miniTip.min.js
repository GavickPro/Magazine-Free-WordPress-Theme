/*!
 * miniTip v1.5.0
 *
 * Updated: December 9, 2011
 * Requires: jQuery v1.3+
 *
 * (c) 2011, James Simpson
 * http://goldfirestudios.com
 *
 * Dual licensed under the MIT and GPL
 *
 * Documentation found at:
 * http://goldfirestudios.com/blog/81/miniTip-jQuery-Plugin
*/
(function(a){a.fn.miniTip=function(f){var i={title:"",content:false,delay:300,anchor:"n",event:"hover",fadeIn:200,fadeOut:200,aHide:true,maxW:"250px",offset:5,doHide:false},h=a.extend(i,f);if(!a("#miniTip")[0]){a("body").append('<div id="miniTip"><div id="miniTip_t"></div><div id="miniTip_c"></div><div id="miniTip_a"></div></div>')}var e=a("#miniTip"),g=a("#miniTip_t"),b=a("#miniTip_c"),c=a("#miniTip_a");if(h.doHide){e.stop(true,true).fadeOut(h.fadeOut);return false}return this.each(function(){var m=a(this);var d=h.content?h.content:m.attr("title");if(d!=""&&typeof d!="undefined"){window.delay=false;var n=false,o=true;if(!h.content){m.removeAttr("title")}if(h.event=="hover"){m.hover(function(){e.removeAttr("click");o=true;j.call(this)},function(){o=false;k()});if(!h.aHide){e.hover(function(){n=true},function(){n=false;setTimeout(function(){if(!o&&!e.attr("click")){k()}},20)})}}else{if(h.event=="click"){h.aHide=true;m.click(function(){e.attr("click","t");if(e.data("last_target")!==m){j.call(this)}else{if(e.css("display")=="none"){j.call(this)}else{k()}}e.data("last_target",m);return false});a("html").click(function(p){if(e.css("display")=="block"&&!a(p.target).closest("#miniTip").length){k()}})}}var j=function(){if(h.show){h.show.call(this,h)}if(h.content&&h.content!=""){d=h.content}b.html(d);if(h.title!=""){g.html(h.title).show()}else{g.hide()}if(h.render){h.render(e)}c.removeAttr("class");e.hide().width("").width(e.width()).css("max-width",h.maxW);var K=m.is("area");if(K){var H,D=[],B=[],L=m.attr("coords").split(",");function A(y,x){return y-x}for(H=0;H<L.length;H++){D.push(L[H++]);B.push(L[H])}var u=m.parent().attr("name"),s=a("img[usemap=\\#"+u+"]").offset(),v=parseInt(s.left,10)+parseInt((parseInt(D.sort(A)[0],10)+parseInt(D.sort(A)[D.length-1],10))/2,10),E=parseInt(s.top,10)+parseInt((parseInt(B.sort(A)[0],10)+parseInt(B.sort(A)[B.length-1],10))/2,10)}else{var E=parseInt(m.offset().top,10),v=parseInt(m.offset().left,10)}var J=K?0:parseInt(m.outerWidth(),10),r=K?0:parseInt(m.outerHeight(),10),F=e.outerWidth(),M=e.outerHeight(),G=Math.round(v+Math.round((J-F)/2)),q=Math.round(E+r+h.offset+8),w=(Math.round(F-16)/2)-parseInt(e.css("borderLeftWidth"),10),z=0,p=(v+J+F+h.offset+8)>parseInt(a(window).width(),10),I=(F+h.offset+8)>v,C=(M+h.offset+8)>E-a(window).scrollTop(),t=(E+r+M+h.offset+8)>parseInt(a(window).height()+a(window).scrollTop(),10),N=h.anchor;if(I||h.anchor=="e"&&!p){if(h.anchor=="w"||h.anchor=="e"){N="e";z=Math.round((M/2)-8-parseInt(e.css("borderRightWidth"),10));w=-8-parseInt(e.css("borderRightWidth"),10);G=v+J+h.offset+8;q=Math.round((E+r/2)-(M/2))}}else{if(p||h.anchor=="w"&&!I){if(h.anchor=="w"||h.anchor=="e"){N="w";z=Math.round((M/2)-8-parseInt(e.css("borderLeftWidth"),10));w=F-parseInt(e.css("borderLeftWidth"),10);G=v-F-h.offset-8;q=Math.round((E+r/2)-(M/2))}}}if(t||h.anchor=="n"&&!C){if(h.anchor=="n"||h.anchor=="s"){N="n";z=M-parseInt(e.css("borderTopWidth"),10);q=E-(M+h.offset+8)}}else{if(C||h.anchor=="s"&&!t){if(h.anchor=="n"||h.anchor=="s"){N="s";z=-8-parseInt(e.css("borderBottomWidth"),10);q=E+r+h.offset+8}}}if(h.anchor=="n"||h.anchor=="s"){if((F/2)>v){G=G<0?w+G:w;w=0}else{if((v+F/2)>parseInt(a(window).width(),10)){G-=w;w*=2}}}else{if(C){q=q+z;z=0}else{if(t){q-=z;z*=2}}}c.css({"margin-left":w+"px","margin-top":z+"px"}).attr("class",N);if(delay){clearTimeout(delay)}delay=setTimeout(function(){e.css({"margin-left":G+"px","margin-top":q+"px"}).stop(true,true).fadeIn(h.fadeIn)},h.delay)};var k=function(){if(!h.aHide&&!n||h.aHide){if(delay){clearTimeout(delay)}delay=setTimeout(function(){l()},h.delay)}};var l=function(){if(!h.aHide&&!n||h.aHide){e.stop(true,true).fadeOut(h.fadeOut);if(h.hide){h.hide.call(this)}}else{setTimeout(function(){k()},200)}}}})}})(jQuery);